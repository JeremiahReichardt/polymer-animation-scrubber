<dom-module id="tween-scrubber" is="dom-bind">

<template>

    <style>

      :host {
        position: fixed;
        bottom: 10px;
        right: 10px;
        width: 40%;
        min-width: 440px;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        text-align: center;
        background-color: white;
        color: black;
        border: 1px solid gray;
        z-index: 1000;
      }

      .slider {
        display: block;
        width:420px;
        margin:auto;
        margin-top: 12px;
      }
      .sliderValues {
        margin:10px;
      }

      .sliderValues span {
        font-size:24px;
      }

      #progressSlider {
        width: 350px;
        min: 0;
        max: 100;
        step: 1;
        /*slide: function(event, ui) {
          tl.progress(ui.value).pause();
        }
        */
      }

      #timeScaleSlider {
        width: 250px;
        min: 0.25;
        max: 4;
        step: 0.25;
        /*slide: function(event, ui) {
          tl.timeScale(ui.value);
          timeScale.html(ui.value)
        },
        change: function() {
          if(tl.paused()){
            tl.resume();
          }
          if(tl.progress() === 1){
            tl.restart();
          }

          if(tl.reversed() && tl.progress() === 0){
            tl.restart();
          }
        }
        */
      }

      button {
        padding:1em;
        margin:20px 0 10px 0;
        font-size:12px;
        cursor:pointer;
      }

    </style>


    <div class="sliderValues">time: <span
        id="time"></span>s / progress: <span id="progress">{{progressPercent}}</span>

    <paper-slider pin min="0" max="1" value="{{progressValue}}" step="0.001" class="slider" id="progressSlider"></paper-slider>
    <div>{{data.time}}</div>
    </div>
    <button id="playBtn">play()</button>
    <button id="pauseBtn">pause()</button>
    <button id="resumeBtn">resume()</button>
    <button id="reverseBtn">reverse()</button>
    <button id="restartBtn">restart()</button>

    <div style="text-align:left; width:420px; margin:auto">
      <paper-slider pin min="0.25" max="4" value="{{timeScale}}" step="0.25" class="slider" id="timeScaleSlider"></paper-slider>
      </div>
      <div class="sliderValues" style="display:inline-block">timeScale: <span
          id="timeScale">{{timeScale}}</span>
      </div>
    </div>  
    <iron-meta key="controls" value="WOOOOAH!"></iron-meta>

  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'tween-scrubber',

        listeners: {
          'progressSlider.change' : 'updateProgressSlider',
          'timeScaleSlider.change' : 'updateTimeScale',
        },

        updateProgressSlider: function(e) {
          this.progressValue = e.target.immediateValue;
        },

        updateTimeScale: function(e) {
          this.timeScale = e.target.immediateValue;
        },


        ready: function(){
          CSSPlugin.defaultTransformPerspective = 400;
          this.progressValue = 0;
          this.timeScale = 1;
        },

        properties: {
          progressValue: {
            type: Number,
            notify: true,
          },
          timeScale: {
            type: Number,
            notify: true,
          },

          data: {
            type: Object,
            notify: true,
            computed: 'setData(progressValue, timeScale)',
            observer: 'setDataObject',
          },
          progressPercent: {
            type: Number,
            computed: 'percentify(progressValue)'
          },
          headline: {
            type: String,
            notify: true
          }
        },

        setData: function(prog, time){
          return {
            progressValue: prog, 
            timeScale: time
          }
        },

        setDataObject: function(newValue, oldValue){
          console.log('CONTROLLER data: ' + JSON.stringify(this.data));
          this.progressValue = newValue.progressValue;
          this.timeScale = newValue.timeScale;
        },

        percentify: function(val) {
          return Math.floor(val * 100) +'%';
        },

      });
    })();
  </script> 

</dom-module>
