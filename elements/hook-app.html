<link rel="import" href="../bower_components/carbon-route/carbon-location.html">
<link rel="import" href="../bower_components/carbon-route/carbon-route.html">
<link rel="import" href="../bower_components/carbon-route/carbon-route-converter.html">

<link rel="import" href="./hook-nav.html">
<link rel="import" href="./hook-page-home.html">
<link rel="import" href="./hook-page-media.html">
<link rel="import" href="./hook-page-story.html">
<dom-module id="hook-app">
    <template>
        <style></style>
        <carbon-location route="{{route}}" use-hash-as-path></carbon-location>
        <carbon-route route="{{route}}" pattern="/:page" data="{{data}}" tail="{{tail}}"></carbon-route>
        <hook-nav></hook-nav>
        <main></main>
    </template>
    <script>
        Polymer({
            is: 'hook-app',
            observers: [
                '_onRouteChange(route)'
            ],
            _onRouteChange: function(route) {
                if (route.path.length !== 0) {
                    switch( route.path ) {
                        case '/home':
                            this.nextPageTageName = 'hook-page-home';
                            break;
                        case '/media':
                            this.nextPageTageName = 'hook-page-media';
                            break;
                        case '/story':
                            this.nextPageTageName = 'hook-page-story';
                            break;
                    }
                    if( this.lastPage ) {
                        this.lastPage.hide(this.showNextPage.bind(this));
                    } else {
                        document.getElementsByTagName('hook-nav')[0].show(this.showNextPage.bind(this));
                    }
                }
            },
            attached: function() {
                if (!this.route.path) {
                    this.set('route.path', '/home');
                }
            },
            showNextPage: function() {
                document.getElementsByTagName('main')[0].innerHTML = '';
                this.lastPage = document.getElementsByTagName('main')[0].appendChild(document.createElement(this.nextPageTageName));
                this.lastPage.show();
            },
            lastPage:null,
            nextPageTageName:null
        });
    </script>
</dom-module>